name: docker image

on:
  workflow_dispatch:

jobs:
 build:
  runs-on: ubuntu-latest
  steps:
   - uses: actions/checkout@v4
   - uses: actions/setup-java@v4
     with:
      java-version: '17'
      distribution: 'temurin'
   - name: Build with Maven
     run: mvn -B package --file pom.xml
   - name: Create new directory
     run: |
        mkdir staging 
        cp target/*.war staging/
   - name: publish artifacts
     uses: actions/upload-artifact@v3
     with:
      name: Package
      path: staging
   - name: Build & push Docker image
     uses: mr-smithers-excellent/docker-build-push@v4
     with:
      image: divyaprabhavathi1012/javacode:java  # Your image name and tag
      file: ./Dockerfile  # Path to your Dockerfile
      push: true  # Push the image to registry
      registry: docker.io  # Provide the Docker registry URL
      username: ${{ secrets.DOCKER_USERNAME }}
      password: ${{ secrets.DOCKER_PASSWORD }}

