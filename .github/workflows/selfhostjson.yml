name: JSON file

on: 
  workflow_dispatch:

jobs:
  download_json:
    runs-on: self-hosted  # Specify self-hosted runner

    steps:
      - name: Download JSON file
        run: |
         Invoke-WebRequest -Uri "https://raw.githubusercontent.com/DivyaPrabhavathi/Maven/main/NSI.json" -OutFile "NSI.json"
        shell: powershell

      - name: assign the value to the json file
        env:
          DOCKER_USERNAME: ${{ secrets.DOCKER_USERNAME }}
          DOCKER_PASSWORD: ${{ secrets.DOCKER_PASSWORD }}
          ENV_NAME: ${{ env.ENV_NAME }} 
        run: |
         # Read JSON file
          echo "ENV_NAME = $ENV_NAME" >> $GITHUB_ENV
          $json = Get-Content NSI.json -Raw | ConvertFrom-Json
          $json.USERNAME = "$env:DOCKER_USERNAME"
          $json.PASSWORD = "$env:DOCKER_PASSWORD"
          $json.NAME = "$env:ENV_NAME"
          $json | ConvertTo-Json | Set-Content -Path NSI.json 
        shell: powershell

