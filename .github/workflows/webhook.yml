name: Update JSON with Secrets
 
on:
  push:
    branches:
      - main  # or the branch you want this workflow to run on
 
jobs:
  update-json:
    runs-on: ubuntu-latest
 
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
 
      - name: Set secret values in JSON
        run: |
          # Read the current content of the JSON file
          json_content=$(cat job_dependencies/job_dependencies.json)
          
          # Update the JSON file with the secret values
          updated_json=$(echo "$json_content" | jq \
            --arg secret1 "${{ secrets.DOCKER_USERNAME }}" \
            --arg secret2 "${{ secrets.DOCKER_PASSWORD }}" \
            
            '.key1 = $secret1 | .key3 = $secret2')
 
          # Write the updated content back to the JSON file
          echo "$updated_json" > job_dependencies/job_dependencies.json
 
      - name: Commit and push changes
        run: |
          git config --global user.name 'github-actions'
          git config --global user.email 'github-actions@github.com'
          git add path/to/your-file.json
          git commit -m "Update JSON with secret values"
          git pushname: JSON secret
 
